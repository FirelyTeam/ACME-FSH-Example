- name: id-mandatory
  status: "Checking if all resources have an id"
  predicate: id.exists()
  error-message: "Resource {{filepath}} must have an id"
  files:
    - "!testing/*"

- name: no-snapshot
  status: "Checking that structure definitions do not have a pre-generated snapshot"
  filter: StructureDefinition
  predicate: snapshot.element.count() = 0
  error-message: You should not generate a snapshot in your source. Allow the tools to generate the snapshot.
  files:
    - "!testing/*"

- name: canonical-starts-with
  filter: url.exists() and ImplementationGuide.exists().not()
  # Excluding IGs for now, since they have a Simplifier.net canonical
  status: "Checking if canonical URL starts with correct base"
  predicate: url.startsWith('https://fake-acme.org/fhir/')
  error-message: "Canonical URL doesn't start with correct base"

- name: publisher-filled
  filter: (StructureDefinition or ValueSet or CodeSystem or CapabilityStatement or SearchParameter or NamingSystem or ConceptMap).exists()
  # Excluding IGs for now, since they don't have a way to set metadata
  status: "Checking if all resources have publisher filled"
  predicate: publisher.exists() and (publisher in ('ACME Corp'))
  error-message: "Publisher not filled (correctly)"